# FIR数字滤波器设计和实现

$$
y(n) = \sum^{N-1}_{k = 0}b_kx(n-k) =  \sum^{N-1}_{k = 0}h(k)x(n-k) \\
可得b_k = h(k)\\
传输函数：H(Z) = \sum^{N-1}_{k = 0}h(k)z^{-k}
$$

IIR滤波器无法直接达到线性相位的特性，而FIR可以，所以FIR的设计除了求出$h(n)$，还需要满足**线性相位**的条件

## 相位失真与线性相位

不同的频率分量通过滤波器产生的相位延迟不同，造成了相位失真。

解决方法之一是：使得随着频率的变化而改变相位，使得滤波器具有**线性相位**的特性

## 线性相位FIR滤波器的条件和特性

已知FIR滤波器的频率响应：
$$
H\left(e^{j w}\right)=H(w) e^{j \theta(w)}=\sum_{n=0}^{N-1} h(n) e^{-j w n}
$$
滤波器的相位延时有：
$$
\begin{aligned}
&\text { 相延时： } \tau_{p}(w)=-\frac{\theta(w)}{w} \\

&\text { 群延时： } \tau_{g}(w)=-\frac{d \theta(w)}{d w}
\end{aligned}
$$

### 分别讨论

#### 恒相延时和恒群延时同时成立

$$
h(n) = h[(N-1)-n]
$$

即$h(n)$关于$(N-1)/2$偶对称，N为奇数和偶数分开讨论。

#### 恒群延时单独成立

$$
h(n) = - h[(N-1)-n]
$$

即$h(n)$关于$(N-1)/2$奇对称，N为奇数和偶数分开讨论。

### 线性相位FIR滤波器的条件和特性

#### 条件

$$
h(n) = \pm h[(N-1)-n]
$$

即$h(n)$关于$(N-1)/2$成奇对称或偶对称。

#### 特性

传输函数有
$$
H(z) = \pm z^{-(N-1)}H\left(z^{-1}\right)
$$
零点成倒数对、共轭对出现：
$$
z_i, \, z^*_i, \, \frac{1}{z_i} ,\, \frac{1}{z^*_i}
$$

## 窗函数法设计FIR滤波器

### 思路

理想FIR频率响应：
$$
H_d\left(e^{j\omega}\right) \stackrel{F}{\longrightarrow}h_d(n)（无限时宽）
$$
思路一：寻找有限长的$h(n)$去逼近$h_d(n)$

窗函数法：用窗函数$w_R(n)$对$h_d(n)$截短，得到有限长$h(n)$（即完成了有限长的$h(n)$去逼近$h_d(n)$）

### 窗函数法性能分析
